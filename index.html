<!DOCTYPE html>
<html>
  <head>
    <title>vidtest</title>
    <meta charset="UTF-8">   
    <style>
      #captions {
        background: transparent;
        color: white;
        font-family: Helvetica, Arial, Ubuntu, sans-serif;
        font-size: 20px;
        left: 30px;
        position: absolute;
        text-shadow:
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        1px 1px 0 #000;
        top: 280px;
        /* -webkit-text-stroke: 1px black; */
      }
      #transcriptEdit {
        border: 1px solid black;
        height: 100px;
        overflow-y: scroll;
      }
    </style>
  </head>

  <body>

    <div id="vidId">
      You need Flash player 8+ and JavaScript enabled to view this video.
    </div>

    <div id="captions"></div>

    <div id="Viewer">
      Select transcript
    </div>
    <div id="Editor">
      Select language from dropdown / type in autocomplete<br />
      Select time | Text (with character limit) | Duration<br />
    </div>
    <div id="starp">Start/Stop</div>
    <div id="skipBack">Skip back 1 second</div>
    <div id="timeStamp"></div>
    <div id="timeClick">Click for time display [test]</div>
    <div id="vidCode"></div>

    <div id="transcriptEdit">
      <div id="transcriptLine1">This a test of the CamStudio microphone.</div>
      <div id="transcriptLine2">It's just dangling from my ear.</div>
      <div id="transcriptLine3">Um, this is how we learn math.</div>
      <div id="transcriptLine4">Whoops!</div>
      <div id="transcriptLine5">Let's click click click delete "h."</div>
      <div id="transcriptLine6">Good.</div>
      <div id="transcriptLine7">Is it not recording?</div>
    </div>
    <form>
      <select id="selectLanguage"><option selected="selected">choose language</option><option id="af">Afrikaans<option id="id">Bahasa Indonesia</option> <option id="ms">Bahasa Malaysia</option> <option id="ca">Català</option> <option id="cs">Čeština</option><option id="da">Dansk</option> <option id="de">Deutsch</option><option id="et">Eesti</option><option id="en-GB">English (UK)</option><option id="en">English (US)</option><option id="es">Español (España)</option><option id="es-419">Español (Latinoamérica)</option><option id="eu">Euskara</option><option id="fil">Filipino</option>
        <option id="fr">Français</option><option id="fr-CA">Français (Canada)</option><option id="gl">Galego</option><option id="hr">Hrvatski</option><option id="zu">IsiZulu</option><option id="is">Íslenska</option><option id="it">Italiano</option><option id="sw">Kiswahili</option><option id="lv">Latviešu valoda</option>
        <option id="lt">Lietuvių</option><option id="hu">Magyar</option><option id="nl">Nederlands</option><option id="no">Norsk</option><option id="pl">Polski</option><option id="pt-PT">Português</option><option id="pt">Português (Brasil)</option><option id="ro">Română</option><option id="sk">Slovenčina</option><option id="sl">Slovenščina</option><option id="fi">Suomi</option><option id="sv">Svenska</option>
        <option id="vi">Tiếng Việt</option><option id="tr">Türkçe</option> <option id="bg">Български</option><option id="ru">Русский</option><option id="sr">Српски</option><option id="uk">Українська</option><option id="el">Ελληνικά</option><option id="iw">עברית</option> <option id="ur">اردو</option> <option id="ar">العربية</option><option id="fa">فارسی</option><option id="mr">मराठी</option><option id="hi">हिन्दी</option><option id="bn">বাংলা</option>
        <option id="gu">ગુજરાતી</option><option id="ta">தமிழ்</option><option id="te">తెలుగు</option><option id="kn">ಕನ್ನಡ</option><option id="ml">മലയാളം</option> <option id="th">ภาษาไทย</option><option id="am">አማርኛ</option><option id="zh-CN">中文 (简体)</option> <option id="zh-TW">中文 (繁體)</option> <option id="zh-HK">中文 (香港)</option><option id="ja">日本語</option><option id="ko">한국어</option></select>
      <input type="submit" value="Save as Draft" id="submitDraft" />
      <input type="submit" value="Publish as Final" id="submitFinal" />
    </form>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

    <!-- Begin testing code from YT, Adobe. This is the YT recommended way to pass vid rather than iframe. -->
    <script src="swfobject.js"></script>    
    <script>
      //aaron added for var sub in vid link
      var vidCode = '3BJ9YXy6zQk'

      // embed video on page
      var params = { allowScriptAccess: 'always' };
      var atts = { id: 'myytplayer' };
      swfobject.embedSWF('http://www.youtube.com/v/' + vidCode + '?enablejsapi=1&playerapiid=ytplayer&version=3',
      'vidId', '420', '315', '8', null, null, params, atts);

    </script>
    <!-- End testing code from YT, Adobe. This is the YT recommended way to pass vid rather than iframe. -->

    <script>
      // load video timer display
      function onYouTubePlayerReady(playerId) {
        window.ytvid = document.getElementById('myytplayer');
        console.log('Player state ' + (ytvid.getPlayerState().toString()));
        setInterval(updateCurrentTime, 100);
        captionTime(0.0);
      }
      // the updateCurrentTime function could be made more generic maybe with video name as an argument
      function updateCurrentTime() {
        if (ytvid.getPlayerState() === 1) {
          $('#timeStamp').html(ytvid.getCurrentTime().toFixed(1));
          captionTime(ytvid.getCurrentTime());
        }
      }
      var transcript = {0: 'This a test of the CamStudio microphone.', 3: 'It\'s just dangling from my ear.', 5: 'Um, this is how we learn math.', 10: 'Whoops!', 13.0: 'Let\'s click click click delete "h."', 18.5: 'Good.', 20: '', 24.0: 'Is it not recording?', 25.8: ''};
      function captionTime(currentTime) {
        if ((transcript[Math.round(currentTime * 10) / 10]) === undefined) {          
          // console.log((Math.round(currentTime * 10) / 10) + '\tu');
        }
        else {
          $('#captions').html(transcript[Math.round(currentTime * 10) / 10]);
          // console.log((Math.round(currentTime * 10) / 10) + '\tsub');
        }
      }

      // start / stop video control
      $('#starp').click(function() {
        if (ytvid.getPlayerState() === 1) {
          ytvid.pauseVideo(); 
        }
        else {
          ytvid.playVideo();
        }
      });

      // skip back control
      $('#skipBack').click(function() {
        ytvid.seekTo((ytvid.getCurrentTime() - 1), true);
        console.log(ytvid.getCurrentTime());
      });

      // mark time with mouse click
      $('#timeClick').mousedown(function() {
        console.log(ytvid.getCurrentTime());
      });
      $('#timeClick').mouseup(function() {
        console.log(ytvid.getCurrentTime());
      });

      // find YT username
      // $('#username').html(document.getElementById('yt-masthead-user-displayname').innerHTML);

      // find vidID
      // var vidURL = document.URL.match(/v=.........../).toString().substring(2,13);
      $('#vidCode').html(vidCode);

      // return to YouTube button
      $('a#returnYT').click(function() {
        return document.URL = ('//www.youtube.com/'+ vidURL);
        alert('123');
      });

      // best alternative to yt.setConfig search is search page for FEEDBACK_LOCALE_LANGUAGE
      //var userLanguage = $('script').text().match(/'FEEDBACK_LOCALE_LANGUAGE': ".*?"/).toString().match(/".*?"/).toString().replace(/\"/g, '');
      //$('#' + userLanguage).attr('selected', true);


      // not getting latest form edit content
      $('#text').keyup(function() {
        var activeForm = (document.getElementById('text').innerHTML);
        console.log(activeForm);
      });

      </script>
    </body>
  </html>
